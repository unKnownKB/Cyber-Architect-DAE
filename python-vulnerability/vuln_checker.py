import scanner  # Import the scanner module

def check_vulnerabilities(services):
    vuln_db = {
        'Apache': {'2.2': 'CVE-2017-15710', '2.4': 'OK'},
        'OpenSSH': {'7.2': 'CVE-2016-10012', '8.0': 'OK'}
    }

    issues = []
    for service in services:
        product = service['product']
        version = service['version']
        if product in vuln_db and version in vuln_db[product]:
            cve = vuln_db[product][version]
            if cve != 'OK':
                issues.append((product, version, cve))
    return issues

if __name__ == "__main__":
    target_ip = input("Enter target IP address: ")  # Or hardcode: target_ip = "your_target_ip"
    services = scanner.scan_target(target_ip)  # Get scan results
    vulns = check_vulnerabilities(services)
    for v in vulns:
        print(f"Found: {v[0]} {v[1]} â†’ {v[2]}")