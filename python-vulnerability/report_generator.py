from fpdf import FPDF
import scanner
import vuln_checker

def generate_pdf_report(filename, target, scan_data, vulnerabilities):
    pdf = FPDF()
    pdf.add_page()
    pdf.set_font("Arial", size=12)
    pdf.cell(200, 10, f"Vulnerability Report for {target}", ln=True)

    pdf.cell(200, 10, "Open Ports and Services:", ln=True)
    for s in scan_data:
        line = f"Port {s['port']} - {s['product']} {s['version']} - {s['state']}"
        pdf.cell(200, 10, line, ln=True)

    pdf.cell(200, 10, "", ln=True)
    pdf.cell(200, 10, "Detected Vulnerabilities:", ln=True)
    for v in vulnerabilities:
        line = f"{v[0]} {v[1]} â†’ {v[2]}"
        pdf.cell(200, 10, line, ln=True)

    pdf.output(filename)
    print(f"[+] PDF report saved as: {filename}")

# Example use
if __name__ == "__main__":
    target = input("Enter target IP address: ")  # Or hardcode
    scan_data = scanner.scan_target(target)
    vulnerabilities = vuln_checker.check_vulnerabilities(scan_data)
    generate_pdf_report("vulnerability_report.pdf", target, scan_data, vulnerabilities)